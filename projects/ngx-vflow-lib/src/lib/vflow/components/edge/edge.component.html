@if (model().type === 'default') {
  <svg:path
    class="edge"
    [attr.d]="model().path().path"
    [attr.marker-start]="markerStartUrl()"
    [attr.marker-end]="markerEndUrl()"
    [class.edge_selected]="model().selected()" />

  <svg:path #interactiveEdge class="interactive-edge" [attr.d]="model().path().path" (mousedown)="onEdgeMouseDown()" />
}

@if (model().type === 'template' && edgeTemplate()) {
  @if (edgeTemplate(); as edgeTemplate) {
    <ng-container
      [ngTemplateOutlet]="edgeTemplate"
      [ngTemplateOutletContext]="edgeContext"
      [ngTemplateOutletInjector]="injector" />

    <svg:path #interactiveEdge class="interactive-edge" [attr.d]="model().path().path" />
  }
}

@if (model().edgeLabels.start; as label) {
  <svg:g
    edgeLabel
    [model]="label"
    [point]="model().path().points.start"
    [edgeModel]="model()"
    [htmlTemplate]="edgeLabelHtmlTemplate()" />
}

@if (model().edgeLabels.center; as label) {
  <svg:g
    edgeLabel
    [model]="label"
    [point]="model().path().points.center"
    [edgeModel]="model()"
    [htmlTemplate]="edgeLabelHtmlTemplate()" />
}

@if (model().edgeLabels.end; as label) {
  <svg:g
    edgeLabel
    [model]="label"
    [point]="model().path().points.end"
    [edgeModel]="model()"
    [htmlTemplate]="edgeLabelHtmlTemplate()" />
}

<!-- Source reconnect handle -->
@if (model().sourceHandle(); as source) {
  <svg:circle
    class="reconnect-handle"
    r="10"
    [attr.cx]="source.pointAbsolute().x"
    [attr.cy]="source.pointAbsolute().y"
    (mousedown)="startReconnection($event, source)" />
}

@if (model().targetHandle(); as target) {
  <svg:circle
    class="reconnect-handle"
    r="10"
    [attr.cx]="target.pointAbsolute().x"
    [attr.cy]="target.pointAbsolute().y"
    (mousedown)="startReconnection($event, target)" />
}
